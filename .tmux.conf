# ████████╗███╗   ███╗██╗   ██╗██╗  ██╗
# ╚══██╔══╝████╗ ████║██║   ██║╚██╗██╔╝
#    ██║   ██╔████╔██║██║   ██║ ╚███╔╝ 
#    ██║   ██║╚██╔╝██║██║   ██║ ██╔██╗ 
#    ██║   ██║ ╚═╝ ██║╚██████╔╝██╔╝ ██╗
#    ╚═╝   ╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═╝

set -g default-shell /usr/bin/zsh
set -g default-command "$SHELL"
unbind r
bind r source-file ~/.tmux.conf
set -g prefix C-z
unbind C-b
set -g mouse on

#  Binding ALT+1-0 to go to window 1-10 in a session 

bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
bind -n M-0 select-window -t 10


# Binding Open/Closing tabs/sessions:

bind-key C-t new-session
# bind-key C-w kill-window
bind-key w kill-window
bind-key -n C-t new-window

# Setting statusline/bar position to be at the bottom

set -g status-position bottom

set -g popup-border-lines single
set -g popup-style "bg=default"

bind-key h split-window -hb -c "#{pane_current_path}"
bind-key j split-window -v -c "#{pane_current_path}"
bind-key k split-window -vb -c "#{pane_current_path}"
bind-key l split-window -h -p 30 -c "#{pane_current_path}"
unbind -n M-h
unbind -n M-j
unbind -n M-k
unbind -n M-l
unbind-key -n C-w

# Why doesn't this work?

bind C-l display-popup \
  -d "#{pane_current_path}" \
  -w 90% \
  -h 90% \
  -E "lazygit"

bind p display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80%

bind-key > next-window
bind-key < previous-window

set -g base-index 1
set -g renumber-windows on
set -g escape-time 0
set -g allow-passthrough on

bind-key -n C-S-Right swap-window -t -1
bind-key -n C-S-Right swap-window -t +1

setw -g pane-base-index 1

# sync panes - write the same thing everywhere
bind-key n set-window-option synchronize-panes\; display-message "Sync mode toggled"

set-option -a terminal-features 'xterm-256color:RGB'
setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
unbind -T copy-mode-vi Space
bind P paste-buffer

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin "janoamaral/tokyo-night-tmux"
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin '27medkamal/tmux-session-wizard'

# SessionX config
set -g @sessionx-bind 'T'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-window-height '90%'
set -g @sessionx-window-width '75%'
set -g @sessionx-preview-enabled 'on'
set -g @sessionx-preview-location 'right'
set -g @sessionx-preview-ratio '50%'
set -g @sessionx-filter-current 'true'

# Session Wizard configuration
unbind C-s
set -g @session-wizard 's S'
set -g @session-wizard-height 60
set -g @session-wizard-width 60

# Theme settings (UI)
set -g @tokyo-night-tmux_theme night             # storm | day | default to 'night'
set -g @tokyo-night-tmux_transparent 1            # 1 or 0
set -g @tokyo-night-tmux_window_id_style fsquare
set -g @tokyo-night-tmux_pane_id_style hsquare
set -g @tokyo-night-tmux_zoom_id_style dsquare
set -g @tokyo-night-tmux_show_path 0
set -g @tokyo-night-tmux_show_datetime 0


set -g @continuum-restore 'on'
set-hook -g session-created 'rename-window "Neovim"; send-keys "nvim" C-m; new-window -n "Command Line"

# Enable TPM
run '~/.tmux/plugins/tpm/tpm'
set-option -g allow-rename off
set-option -g automatic-rename off
set -g status on

bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "send-keys C-l"

# Disable visual bell/notifications
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

unbind -n C-h
bind -n C-h send-keys C-h
unbind -n C-j
unbind -n Tab
unbind Tab

set -g pane-border-status off
set -g pane-border-format ''
set -g pane-border-lines single

set-environment -g FZF_DEFAULT_OPTS "--height=50% --layout=reverse --no-border --margin=1,5 --padding=1,2 --preview-window=right:90%:wrap --color=bg+:-1,bg:-1,spinner:#9ece6a,hl:#89ddff --color=fg:#a9b1d6,header:#f38ba8,info:#ff9e64,pointer:#ff9e64 --color=marker:#7aa2f7,fg+:#cdd6f4,prompt:#f7768e,hl+:#89ddff --color=selected-bg:-1 --color=border:#45475a,label:#ff9e64"

# Session switching bindings
bind-key -n C-1 switch-client -t WorkFlow
bind-key -n C-2 switch-client -t AI
